Тема: Вопрос по API v2: получение архивных лидов через /v2api/customer/index

Здравствуйте, команда AlfaCRM!

Меня зовут Руслан, я работаю с компанией eCademy (ecademyua.alfacrm.com).

Обращаюсь к вам с вопросом по работе API v2. Мы разрабатываем систему аналитики лидов и столкнулись с проблемой получения архивных (отклоненных) лидов через API.

## ПРОБЛЕМА

Через endpoint `/v2api/customer/index` мы успешно получаем активных лидов (3,592 записи), но не можем получить архивные лиды, которые видны в Web UI на вкладке "Архів (відмови)" (~7,788 записей).

При любых параметрах запроса поля `lead_reject_id` и `customer_reject_id` всегда возвращаются со значением `null`, даже когда в Web UI у этих лидов указана причина отказа.

## ЧТО МЫ ПРОТЕСТИРОВАЛИ

Мы провели обширное тестирование с различными комбинациями параметров:

**1. Параметры фильтрации архива:**
```json
{"archived": 1}
{"is_archive": 1}
{"archive": 1}
{"only_archived": 1}
```
Результат: Все параметры игнорируются, возвращаются только активные лиды

**2. Фильтрация по lead_reject_id:**
```json
{"lead_reject_id": 44}
{"lead_reject_id": {"$ne": null}}
{"lead_reject_id": {"$exists": true}}
```
Результат: Или игнорируется, или возвращает 0 записей

**3. Различные значения is_study:**
```json
{"is_study": -1}
{"is_study": null}
{"is_study": 99}
```
Результат: Либо 0 записей, либо активные лиды без архивных

**4. Фильтрация по статусам:**
```json
{"lead_status_id": 13}  // "Не розібрано"
{"lead_status_id": 11}  // "Недодзвон"
```
Результат: 0 записей

**5. Запросы БЕЗ is_study:**
```json
{"page": 1, "page_size": 100}
```
Результат: Возвращаются активные студенты (is_study=1), но без архивных

Всего протестировано более 15 различных комбинаций параметров.

## РАБОЧИЕ ENDPOINTS

Мы успешно используем следующие endpoints:
- `/v2api/auth/login` - аутентификация ✅
- `/v2api/customer/index` - получение активных лидов ✅
- `/v2api/lead-reject/index` - список причин отказа (44 шт) ✅
- `/v2api/customer-reject/index` - список причин отказа клиентов (49 шт) ✅
- `/v2api/lead-status/index` - статусы лидов ✅

## ТЕХНИЧЕСКИЕ ДЕТАЛИ

- API Version: v2
- Используемые параметры: `is_study`, `page`, `page_size`, `branch_ids`
- Аутентификация: X-ALFACRM-TOKEN header
- Тип токена: Project API Key
- page_size: тестировали от 10 до 500

## ВОПРОСЫ

1. **Поддерживает ли API v2 получение архивных (отклоненных) лидов?**

2. **Если да, какие параметры нужно использовать в запросе к `/v2api/customer/index`?**

3. **Существует ли альтернативный endpoint для получения архивных лидов?**
   Например:
   - `/v2api/customer/archived`
   - `/v2api/lead/rejected`
   - `/v2api/archive/index`

4. **Требуются ли специальные права доступа или другой тип API ключа для получения архивных данных?**

5. **Если архивные лиды недоступны через публичный API, возможно ли это реализовать в будущих версиях?**

## ПОЧЕМУ ЭТО ВАЖНО

Для полноценной аналитики нам критически важно анализировать причины отказов лидов (lead_reject_id) для оптимизации рекламных кампаний и улучшения качества обработки лидов.

В Web UI эта информация доступна на вкладке "Архів (відмови)", и мы видим ~7,788 архивных записей, но не можем получить их программно через API.

## ДОКУМЕНТАЦИЯ

Мы изучили официальную документацию API, но не нашли информации о работе с архивными лидами. Буду признателен, если вы сможете указать на соответствующий раздел документации или предоставить примеры запросов.

Спасибо за вашу работу и буду благодарен за помощь в решении этого вопроса!

---

С уважением,
Руслан

Email: ruslan9699@icloud.com
Компания: eCademy (ID: 1)
AlfaCRM URL: ecademyua.alfacrm.com
