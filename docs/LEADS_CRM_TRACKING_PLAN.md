# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: Meta Leads + CRM Tracking

## üéØ –¶–µ–ª—å

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –∏ –∞–Ω–∞–ª–∏–∑ –ª–∏–¥–æ–≤ –∏–∑ Meta Ads —Å —Ç—Ä–µ–∫–∏–Ω–≥–æ–º –∏—Ö –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –ø–æ –≤–æ—Ä–æ–Ω–∫–µ –≤ CRM —Å–∏—Å—Ç–µ–º–∞—Ö (AlfaCRM –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, NetHunt –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π).

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### 1. –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

**Meta API (–õ–∏–¥—ã):**
- –≠–Ω–¥–ø–æ–∏–Ω—Ç: `/{PAGE_ID}/leadgen_forms` ‚Üí `/{FORM_ID}/leads`
- –î–∞–Ω–Ω—ã–µ –ø–æ –∫–∞–∂–¥–æ–º—É –ª–∏–¥—É:
  - `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ª–∏–¥–∞
  - `created_time` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
  - `campaign_id`, `campaign_name` - –∫–∞–º–ø–∞–Ω–∏—è
  - `ad_id`, `ad_name` - –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
  - `field_data` - –ø–æ–ª—è —Ñ–æ—Ä–º—ã (email, phone, name, etc.)

**AlfaCRM API (–°—Ç—É–¥–µ–Ω—Ç—ã):**
- –≠–Ω–¥–ø–æ–∏–Ω—Ç: `/v2api/{COMPANY_ID}/student/index`
- –°—Ç–∞—Ç—É—Å—ã –≤–æ—Ä–æ–Ω–∫–∏:
  1. "–ù–µ —Ä–æ–∑—ñ–±—Ä–∞–Ω—ñ" - –Ω–æ–≤—ã–π –ª–∏–¥
  2. "–í—Å—Ç–∞–Ω–æ–≤. –∫–æ–Ω—Ç–∞–∫—Ç (–¶–ê)" - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–æ–Ω—Ç–∞–∫—Ç
  3. "–í –æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—ñ (–¶–ê)" - –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ
  4. "–ù–∞–∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê)" - –Ω–∞–∑–Ω–∞—á–µ–Ω –ø—Ä–æ–±–Ω—ã–π —É—Ä–æ–∫
  5. "–ü—Ä–æ–≤–µ–¥–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê)" - –ø—Ä–æ–≤–µ–¥–µ–Ω –ø—Ä–æ–±–Ω—ã–π —É—Ä–æ–∫
  6. "–ß–µ–∫–∞—î–º–æ –æ–ø–ª–∞—Ç—É" - –æ–∂–∏–¥–∞–Ω–∏–µ –æ–ø–ª–∞—Ç—ã
  7. "–ö—É–ø–∏–ª–∏ (–¶–ê)" - –æ–ø–ª–∞—Ç–∏–ª (–∫–æ–Ω–≤–µ—Ä—Å–∏—è)
  8. "–ê—Ä—Ö—ñ–≤ (–¶–ê)" - –∞—Ä—Ö–∏–≤ —Ü–µ–ª–µ–≤–æ–π
  9. "–ù–µ–¥–æ–∑–≤–æ–Ω (–Ω–µ –¶–ê)" - –Ω–µ –¥–æ–∑–≤–æ–Ω–∏–ª–∏—Å—å
  10. "–ê—Ä—Ö—ñ–≤ (–Ω–µ –¶–ê)" - –∞—Ä—Ö–∏–≤ –Ω–µ—Ü–µ–ª–µ–≤–æ–π

**NetHunt API (–£—á–∏—Ç–µ–ª—è):**
- –≠–Ω–¥–ø–æ–∏–Ω—Ç: `/api/records/folder/{FOLDER_ID}`
- –°—Ç–∞—Ç—É—Å—ã –≤–æ—Ä–æ–Ω–∫–∏ —É—á–∏—Ç–µ–ª–µ–π (50+ —Å—Ç–∞—Ç—É—Å–æ–≤ —Å–æ–≥–ª–∞—Å–Ω–æ UI)

### 2. –õ–æ–≥–∏–∫–∞ –ø–æ–¥—Å—á–µ—Ç–∞ –ª–∏–¥–æ–≤

```python
# –ü—Å–µ–≤–¥–æ–∫–æ–¥ –ª–æ–≥–∏–∫–∏
def count_leads_by_status(campaign_id, start_date, end_date):
    # 1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ª–∏–¥—ã –∏–∑ Meta API –¥–ª—è –∫–∞–º–ø–∞–Ω–∏–∏
    leads = get_meta_leads(campaign_id, start_date, end_date)

    # 2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–∏–¥–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤ CRM
    status_counts = {
        "contacted": 0,
        "in_progress": 0,
        "trial_scheduled": 0,
        # ... –≤—Å–µ —Å—Ç–∞—Ç—É—Å—ã
    }

    for lead in leads:
        # –ü–æ–∏—Å–∫ –ª–∏–¥–∞ –≤ CRM –ø–æ email –∏–ª–∏ phone
        crm_record = find_in_crm(lead.email, lead.phone)

        if crm_record:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–µ—Ä–µ–∑ –∫–∞–∫–∏–µ —Å—Ç–∞—Ç—É—Å—ã –ø—Ä–æ—à–µ–ª –ª–∏–¥
            for status in crm_record.status_history:
                if status == "–í—Å—Ç–∞–Ω–æ–≤. –∫–æ–Ω—Ç–∞–∫—Ç (–¶–ê)":
                    status_counts["contacted"] += 1
                elif status == "–ù–∞–∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê)":
                    status_counts["trial_scheduled"] += 1
                # ... –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞

    return status_counts
```

## üõ†Ô∏è –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å –ø–æ–ª—É—á–µ–Ω–∏—è –ª–∏–¥–æ–≤ –∏–∑ Meta API

**–§–∞–π–ª:** `app/services/meta_leads.py`

```python
async def get_leads_for_period(
    page_id: str,
    page_token: str,
    start_date: str,
    end_date: str
) -> List[Dict]:
    """
    –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ª–∏–¥—ã –∑–∞ –ø–µ—Ä–∏–æ–¥ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º.

    Returns:
        [
            {
                "campaign_id": "120226862970630609",
                "campaign_name": "Student/Anatoly/...",
                "leads": [
                    {
                        "id": "24905838062380228",
                        "created_time": "2025-10-08T09:09:27+0000",
                        "email": "snv88@ukr.net",
                        "phone": "+380631045546",
                        "name": "Nata Petrenko",
                        ...
                    }
                ]
            }
        ]
    """
    # 1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ leadgen_forms
    forms = await get_leadgen_forms(page_id, page_token)

    # 2. –î–ª—è –∫–∞–∂–¥–æ–π —Ñ–æ—Ä–º—ã –ø–æ–ª—É—á–∏—Ç—å –ª–∏–¥—ã –∑–∞ –ø–µ—Ä–∏–æ–¥
    all_leads = []
    for form in forms:
        leads = await get_form_leads(
            form["id"],
            page_token,
            start_date,
            end_date
        )
        all_leads.extend(leads)

    # 3. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ª–∏–¥—ã –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º
    grouped = group_by_campaign(all_leads)

    return grouped
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å —Ç—Ä–µ–∫–∏–Ω–≥–∞ –≤ AlfaCRM

**–§–∞–π–ª:** `app/services/alfacrm_tracking.py`

```python
async def track_lead_in_alfacrm(
    email: str,
    phone: str
) -> Dict[str, int]:
    """
    –ù–∞–π—Ç–∏ –ª–∏–¥–∞ –≤ AlfaCRM –∏ –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ç—É—Å—ã —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –ø—Ä–æ—à–µ–ª.

    Returns:
        {
            "found": True,
            "student_id": "12345",
            "statuses": {
                "contacted": True,
                "in_progress": True,
                "trial_scheduled": True,
                "trial_completed": False,
                "purchased": False,
                ...
            }
        }
    """
    # –ü–æ–∏—Å–∫ —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ AlfaCRM
    students = await search_alfacrm_students(email, phone)

    if not students:
        return {"found": False}

    student = students[0]

    # –ú–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–æ–≤ AlfaCRM –Ω–∞ –∫–æ–ª–æ–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
    STATUS_MAPPING = {
        "–í—Å—Ç–∞–Ω–æ–≤. –∫–æ–Ω—Ç–∞–∫—Ç (–¶–ê)": "contacted",
        "–í –æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—ñ (–¶–ê)": "in_progress",
        "–ù–∞–∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê)": "trial_scheduled",
        "–ü—Ä–æ–≤–µ–¥–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê)": "trial_completed",
        "–ö—É–ø–∏–ª–∏ (–¶–ê)": "purchased",
        "–ù–µ–¥–æ–∑–≤–æ–Ω (–Ω–µ –¶–ê)": "not_reached",
        ...
    }

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å—ã
    statuses = {}
    for alfa_status, table_field in STATUS_MAPPING.items():
        statuses[table_field] = check_status(student, alfa_status)

    return {
        "found": True,
        "student_id": student["id"],
        "statuses": statuses
    }
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å —Ç—Ä–µ–∫–∏–Ω–≥–∞ –≤ NetHunt

**–§–∞–π–ª:** `app/services/nethunt_tracking.py`

```python
async def track_lead_in_nethunt(
    email: str,
    phone: str
) -> Dict[str, bool]:
    """
    –ù–∞–π—Ç–∏ –ª–∏–¥–∞ –≤ NetHunt –∏ –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ç—É—Å—ã (–¥–ª—è —É—á–∏—Ç–µ–ª–µ–π).

    Returns:
        {
            "found": True,
            "record_id": "67890",
            "statuses": {
                "contacted": True,
                "interview_scheduled": True,
                ...
            }
        }
    """
    # –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ AlfaCRM, –Ω–æ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π
    pass
```

### –®–∞–≥ 4: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ endpoint /api/meta-data

**–§–∞–π–ª:** `app/main.py` (–æ–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π endpoint)

```python
@app.post("/api/meta-data")
async def get_meta_data(payload: dict):
    """
    –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Meta API + CRM —Ç—Ä–µ–∫–∏–Ω–≥ –∑–∞ –ø–µ—Ä–∏–æ–¥.

    Request:
        {
            "start_date": "2025-10-01",
            "end_date": "2025-10-07"
        }

    Response:
        {
            "ads": [...],  # —Ä–µ–∫–ª–∞–º–∞
            "students": [  # —Å—Ç—É–¥–µ–Ω—Ç—ã —Å CRM —Å—Ç–∞—Ç—É—Å–∞–º–∏
                {
                    "campaign_name": "...",
                    "budget": 100,
                    "leads_count": 50,
                    "contacted": 30,  # +1 –∑–∞ –∫–∞–∂–¥—ã–π –ª–∏–¥ –ø—Ä–æ—à–µ–¥—à–∏–π —Å—Ç–∞—Ç—É—Å
                    "in_progress": 25,
                    "trial_scheduled": 15,
                    "trial_completed": 10,
                    "purchased": 5,
                    ...
                }
            ],
            "teachers": [...]  # —É—á–∏—Ç–µ–ª—è —Å CRM —Å—Ç–∞—Ç—É—Å–∞–º–∏
        }
    """
    start_date = payload.get("start_date")
    end_date = payload.get("end_date")

    # 1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏ –∏–∑ Meta API
    campaigns = await get_campaigns(start_date, end_date)

    # 2. –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ —É—á–∏—Ç–µ–ª–µ–π
    student_campaigns = filter_student_campaigns(campaigns)
    teacher_campaigns = filter_teacher_campaigns(campaigns)

    # 3. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–æ–π –∫–∞–º–ø–∞–Ω–∏–∏
    students_data = []
    for campaign in student_campaigns:
        # 3.1 –ü–æ–ª—É—á–∏—Ç—å –ª–∏–¥—ã –∏–∑ Meta
        leads = await get_campaign_leads(campaign["id"], start_date, end_date)

        # 3.2 –¢—Ä–µ–∫–∏–Ω–≥ –∫–∞–∂–¥–æ–≥–æ –ª–∏–¥–∞ –≤ AlfaCRM
        status_counts = {
            "contacted": 0,
            "in_progress": 0,
            "trial_scheduled": 0,
            ...
        }

        for lead in leads:
            crm_data = await track_lead_in_alfacrm(lead["email"], lead["phone"])
            if crm_data["found"]:
                # +1 –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—à–µ–ª –ª–∏–¥
                for status_key, passed in crm_data["statuses"].items():
                    if passed:
                        status_counts[status_key] += 1

        # 3.3 –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã
        students_data.append({
            "campaign_name": campaign["name"],
            "campaign_link": f"https://facebook.com/campaign/{campaign['id']}",
            "budget": campaign["spend"],
            "leads_count": len(leads),
            **status_counts,  # –≤—Å–µ —Å—á–µ—Ç—á–∏–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤
            # –í—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è –ù–ï –∑–∞–ø–æ–ª–Ω—è–µ–º - –∏—Ö —Å—á–∏—Ç–∞—é—Ç Excel —Ñ–æ—Ä–º—É–ª—ã
        })

    # 4. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π
    teachers_data = []
    # ...

    # 5. –†–µ–∫–ª–∞–º–∞ (–∫—Ä–µ–∞—Ç–∏–≤—ã)
    ads_data = []
    # ...

    return {
        "ads": ads_data,
        "students": students_data,
        "teachers": teachers_data,
        "fetched_at": datetime.now().isoformat()
    }
```

### –®–∞–≥ 5: –î–æ–±–∞–≤–∏—Ç—å Excel —Ñ–æ—Ä–º—É–ª—ã

**–§–∞–π–ª:** `app/excel_export.py` (–æ–±–Ω–æ–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —ç–∫—Å–ø–æ—Ä—Ç–∞)

```python
def add_excel_formulas(ws, sheet_type: str):
    """
    –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É–ª—ã –¥–ª—è –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö –ø–æ–ª–µ–π.

    sheet_type: "students" | "teachers" | "ads"
    """
    if sheet_type == "students":
        # –ù–∞–π—Ç–∏ –∏–Ω–¥–µ–∫—Å—ã –∫–æ–ª–æ–Ω–æ–∫
        headers = [cell.value for cell in ws[1]]

        leads_col = headers.index("–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤") + 1
        target_leads_col = headers.index("–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤") + 1
        purchased_col = headers.index("–ö—É–ø–∏–ª–∏ (–¶–ê)") + 1
        trial_completed_col = headers.index("–ü—Ä–æ–≤–µ–¥–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê)") + 1

        # –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        for row_idx in range(2, ws.max_row + 1):
            # % —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤ = (target_leads / leads) * 100
            target_percent_col = headers.index("% —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤") + 1
            ws.cell(row_idx, target_percent_col).value = f"=IF({get_col_letter(leads_col)}{row_idx}=0,0,{get_col_letter(target_leads_col)}{row_idx}/{get_col_letter(leads_col)}{row_idx}*100)"
            ws.cell(row_idx, target_percent_col).number_format = "0.00%"

            # –ö–æ–Ω–≤–µ—Ä—Å—ñ—è –∑ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ–≥–æ –ø—Ä–æ–±–Ω–æ–≥–æ –≤ –ø—Ä–æ–¥–∞–∂
            conversion_col = headers.index("–ö–æ–Ω–≤–µ—Ä—Å—ñ—è –∑ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ–≥–æ –ø—Ä–æ–±–Ω–æ–≥–æ –≤ –ø—Ä–æ–¥–∞–∂") + 1
            ws.cell(row_idx, conversion_col).value = f"=IF({get_col_letter(trial_completed_col)}{row_idx}=0,0,{get_col_letter(purchased_col)}{row_idx}/{get_col_letter(trial_completed_col)}{row_idx}*100)"
            ws.cell(row_idx, conversion_col).number_format = "0.00%"

            # –¶—ñ–Ω–∞ / –ª—ñ–¥–∞
            cost_per_lead_col = headers.index("–¶—ñ–Ω–∞ / –ª—ñ–¥–∞") + 1
            budget_col = headers.index("–í–∏—Ç—Ä–∞—á–µ–Ω–∏–π –±—é–¥–∂–µ—Ç –≤ $") + 1
            ws.cell(row_idx, cost_per_lead_col).value = f"=IF({get_col_letter(leads_col)}{row_idx}=0,0,{get_col_letter(budget_col)}{row_idx}/{get_col_letter(leads_col)}{row_idx})"
            ws.cell(row_idx, cost_per_lead_col).number_format = "$#,##0.00"

            # ... –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è
```

## üìù –ú–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–æ–≤

### –°—Ç—É–¥–µ–Ω—Ç—ã (AlfaCRM)

| –°—Ç–∞—Ç—É—Å –≤ AlfaCRM | –ü–æ–ª–µ –≤ —Ç–∞–±–ª–∏—Ü–µ |
|------------------|----------------|
| –ù–µ —Ä–æ–∑—ñ–±—Ä–∞–Ω—ñ | `not_processed` |
| –í—Å—Ç–∞–Ω–æ–≤. –∫–æ–Ω—Ç–∞–∫—Ç (–¶–ê) | `contacted` |
| –í –æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—ñ (–¶–ê) | `in_progress` |
| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê) | `trial_scheduled` |
| –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê) | `trial_completed` |
| –ß–µ–∫–∞—î–º–æ –æ–ø–ª–∞—Ç—É | `awaiting_payment` |
| –ö—É–ø–∏–ª–∏ (–¶–ê) | `purchased` |
| –ê—Ä—Ö—ñ–≤ (–¶–ê) | `archived` |
| –ù–µ–¥–æ–∑–≤–æ–Ω (–Ω–µ –¶–ê) | `not_reached` |
| –ê—Ä—Ö—ñ–≤ (–Ω–µ –¶–ê) | `archived_non_target` |

### –£—á–∏—Ç–µ–ª—è (NetHunt)

| –°—Ç–∞—Ç—É—Å –≤ NetHunt | –ü–æ–ª–µ –≤ —Ç–∞–±–ª–∏—Ü–µ |
|------------------|----------------|
| –ù–µ —Ä–æ–∑—ñ–±—Ä–∞–Ω—ñ –ª—ñ–¥–∏ | `not_processed` |
| –í–∑—è—Ç—ñ –≤ —Ä–æ–±–æ—Ç—É | `contacted` |
| –ö–æ–Ω—Ç–∞–∫—Ç (–¶–ê) | `contacted` |
| –ù–ï –¥–æ–∑–≤–æ–Ω (–ù–ï –¶–ê) | `not_reached` |
| –°–ø—ñ–≤–±–µ—Å—ñ–¥–∞ (–¶–ê) | `trial_scheduled` |
| –°–ü –ø—Ä–æ–≤–µ–¥–µ–Ω–æ (–¶–ê) | `trial_completed` |
| –°—Ç–∞–∂—É–≤–∞–Ω–Ω—è (–¶–ê) | `internship` |
| –í—á–∏—Ç–µ–ª—å (–¶–ê) | `teacher_active` |
| ... (50+ —Å—Ç–∞—Ç—É—Å–æ–≤) | ... |

## üî¢ –í—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è (Excel —Ñ–æ—Ä–º—É–ª—ã)

### –°—Ç—É–¥–µ–Ω—Ç—ã

```excel
% —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤ = (–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤ / –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤) * 100
% –Ω–µ —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤ = (–ö—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤ / –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤) * 100
% –í—Å—Ç–∞–Ω. –∫–æ–Ω—Ç–∞–∫—Ç = (–í—Å—Ç–∞–Ω–æ–≤. –∫–æ–Ω—Ç–∞–∫—Ç (–¶–ê) / –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤) * 100
% –í –æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—ñ (–¶–ê) = (–í –æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—ñ (–¶–ê) / –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤) * 100
% –∫–æ–Ω–≤–µ—Ä—Å—ñ—è = (–ö—É–ø–∏–ª–∏ (–¶–ê) / –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤) * 100
% –∞—Ä—Ö—ñ–≤ = (–ê—Ä—Ö—ñ–≤ (–¶–ê) / –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤) * 100
% –Ω–µ–¥–æ–∑–≤–æ–Ω = (–ù–µ–¥–æ–∑–≤–æ–Ω (–Ω–µ –¶–ê) / –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤) * 100
–¶—ñ–Ω–∞ / –ª—ñ–¥–∞ = –í–∏—Ç—Ä–∞—á–µ–Ω–∏–π –±—é–¥–∂–µ—Ç –≤ $ / –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤
–¶—ñ–Ω–∞ / —Ü—ñ–ª—å–æ–≤–æ–≥–æ –ª—ñ–¥–∞ = –í–∏—Ç—Ä–∞—á–µ–Ω–∏–π –±—é–¥–∂–µ—Ç –≤ $ / –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤
% –ù–∞–∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π = (–ù–∞–∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê) / –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤) * 100
% –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π –≤—ñ–¥ –∑–∞–≥–∞–ª—å–Ω–∏—Ö –ª—ñ–¥—ñ–≤ (–¶–ê) = (–ü—Ä–æ–≤–µ–¥–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê) / –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤) * 100
% –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π –≤—ñ–¥ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—Ö –ø—Ä–æ–±–Ω–∏—Ö = (–ü—Ä–æ–≤–µ–¥–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê) / –ù–∞–∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê)) * 100
–ö–æ–Ω–≤–µ—Ä—Å—ñ—è –∑ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ–≥–æ –ø—Ä–æ–±–Ω–æ–≥–æ –≤ –ø—Ä–æ–¥–∞–∂ = (–ö—É–ø–∏–ª–∏ (–¶–ê) / –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–π –ø—Ä–æ–±–Ω–∏–π (–¶–ê)) * 100
```

### –†–µ–∫–ª–∞–º–∞

```excel
CPL = –í–∏—Ç—Ä–∞—á–µ–Ω–æ ($) / –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤
–¶—ñ–Ω–∞ –≤ $ –∑–∞ —Ü—ñ–ª—å–æ–≤–æ–≥–æ –ª—ñ–¥–∞ = –í–∏—Ç—Ä–∞—á–µ–Ω–æ ($) / –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤
% —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤ = (–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤ / –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤) * 100
% –ù–µ —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤ = (–ö—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ —Ü—ñ–ª—å–æ–≤–∏—Ö –ª—ñ–¥—ñ–≤ / –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤) * 100
% –ù–µ –¥–æ–∑–≤–æ–Ω—ñ–≤ = (–ö—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ –¥–æ–∑–≤–æ–Ω—ñ–≤ / –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤) * 100
% –í –æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—ñ = (–ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤ –æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—ñ / –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤) * 100
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏

1. **–ù–ï –∏–∑–º–µ–Ω—è—Ç—å UI —Ç–∞–±–ª–∏—Ü** - –ø–æ–ª—è –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å
2. **–¢–æ–ª—å–∫–æ —Å—á–µ—Ç—á–∏–∫–∏ –∏–∑ CRM** - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Meta API + CRM —Ç—Ä–µ–∫–∏–Ω–≥
3. **–§–æ—Ä–º—É–ª—ã –≤ Excel** - –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è —Å—á–∏—Ç–∞—é—Ç—Å—è —Ñ–æ—Ä–º—É–ª–∞–º–∏, –ù–ï –≤ Python
4. **+1 –∑–∞ —Å—Ç–∞—Ç—É—Å** - –µ—Å–ª–∏ –ª–∏–¥ –ø—Ä–æ—à–µ–ª —Å—Ç–∞—Ç—É—Å, –¥–æ–±–∞–≤–ª—è–µ–º 1 –∫ —Å—á–µ—Ç—á–∏–∫—É
5. **–ü–æ–∏—Å–∫ –≤ CRM** - –ø–æ email –∏–ª–∏ phone –∏–∑ Meta lead
6. **–ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤** - –≤–∞–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å —á—Ç–æ –ª–∏–¥ –º–æ–∂–µ—Ç –ø—Ä–æ–π—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞—Ç—É—Å–æ–≤

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ò–∑—É—á–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É Excel –∏ –º–∞–ø–ø–∏–Ω–≥
2. ‚è≥ –°–æ–∑–¥–∞—Ç—å `app/services/meta_leads.py`
3. ‚è≥ –°–æ–∑–¥–∞—Ç—å `app/services/alfacrm_tracking.py`
4. ‚è≥ –°–æ–∑–¥–∞—Ç—å `app/services/nethunt_tracking.py`
5. ‚è≥ –û–±–Ω–æ–≤–∏—Ç—å `/api/meta-data` endpoint
6. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å Excel —Ñ–æ—Ä–º—É–ª—ã –≤ —ç–∫—Å–ø–æ—Ä—Ç
7. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
